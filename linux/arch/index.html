<!doctype html><html lang=en-us><head><title>arch</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><style>@import "https://fonts.googleapis.com/css2?family=Inconsolata&display=swap";:root{--cursor-visibility:hidden}html,body{width:100%;height:100%;overflow:auto;font-family:inconsolata,monospace;font-size:4vmin;line-height:4.1vmin;font-weight:400}body{margin:0;display:flex;flex-direction:row;justify-content:center;align-items:center}#content{min-width:82vmin;min-height:82vmin}::-webkit-scrollbar{width:10px}::-webkit-scrollbar-track{border-radius:10px;box-shadow:inset 0 0 1px white}::-webkit-scrollbar-thumb{border-radius:10px;box-shadow:0 0 0 1px white}.cursor,#activity-title:after,#activity-content:after,#cd:after,#whoami:after,#cat:after,#tree:after{visibility:var(--cursor-visibility);content:"|";overflow:hidden;color:#fff;animation:blink 500ms linear infinite alternate}@keyframes blink{0%{opacity:0}100%{opacity:1}}@media only screen and (min-width:768px){body{font-size:2.5vmin;line-height:2.6vmin}#content{min-width:60vmin}}:root{--cursor-visibility:hidden}body{align-items:unset;overflow-y:scroll}#content{max-width:80vmin}pre{overflow-x:scroll;white-space:pre}@keyframes blink{0%{opacity:0}100%{opacity:1}}body{background:#002b36}body #terminal{color:#839496}body #user{color:#859900}body #dir{color:#268bd2}body .Typewriter__cursor{color:#839496}a{color:#839496}.navFull{background-color:#353535;font-family:courier new;font-size:17px;display:inline;position:fixed;bottom:0;left:0;width:100%;padding-top:5px;padding:10px;padding-bottom:0}.navCredits{float:right;padding-right:18px;padding-bottom:10px;padding-top:5px}#content::after{content:"\a\a";white-space:pre}</style></head><body><div id=content><span id=activity-title></span><br><span id=activity-content></span><br><script type=text/javascript>async function typewriter(e,t,n){var s=0,o=!1;addText="";const i=document.getElementById(t),a=()=>new Promise(e=>setTimeout(e,n)),r=()=>new Promise(e=>e()),c=()=>i.innerHTML=e.slice(0,s+1)+addText,l=document.createElement("span");for(l.id="blink",i.style.setProperty("--cursor-visibility","visible");s<e.length;){if(e.charAt(s+1)==="<"&&(o=!0),e.charAt(s+1)===">"&&(o=!1),o){s++;continue}requestAnimationFrame(c),n===0?await r():await a(),s++}i.style.setProperty("--cursor-visibility","collapse")}function parseDelay(e){const t=parseInt(e,10);return isNaN(t)?0:t}const titleDelay=parseDelay("0"),contentDelay=parseDelay("0"),typeeffetct=async()=>{await typewriter("\u003cspan id=\u0027terminal\u0027\u003e\u003ch1 id=\u0027title\u0027\u003earch\u003c/h1\u003e\u003c/span\u003e","activity-title",titleDelay),await typewriter(`\u003cspan id=\u0027terminal\u0027\u003e\u003cp\u003eInstall Arch Linux on my daily driver notebook.\u003c/p\u003e
\u003ch2 id=\u0022components-in-this-installation\u0022\u003eComponents in this installation\u003c/h2\u003e
\u003cp\u003eArch Linux is flexible and there are many guides out there that show you how to install it. During my research I found it unpleasant having to read the entire article before knowing what software the article shows to configure for diferent components. Therefore here\u0026rsquo;s the list of what Software I use in my Arch Linux Installation:\u003c/p\u003e
\u003cul\u003e
\u003cli\u003eSystem Type: EFI\u003c/li\u003e
\u003cli\u003ePartitioning: LVM (ext4) on LUKS partition -\u0026gt; all data encrypted (except boot partition)\u003c/li\u003e
\u003cli\u003eEncryption: Keyfile for automatic decryption on boot\u003c/li\u003e
\u003cli\u003eBootloader: systemd-boot\u003c/li\u003e
\u003cli\u003einitramfs: systemd-init hooks\u003c/li\u003e
\u003cli\u003eSWAP: swapfile\u003c/li\u003e
\u003c/ul\u003e
\u003ch2 id=\u0022disclaimer\u0022\u003eDisclaimer\u003c/h2\u003e
\u003cp\u003eI documented in this guide how I installed Arch Linux on my notebook to have a reference I can use if something goes wrong and I need to know how I configured it. It\u0026rsquo;s also a preparation for the installation as I can test this guide on a virtual machine or another computer and if I know that these commands work, I can configure my system in one run. So don\u0026rsquo;t expect to have a full guide showing any possibilities and tricks to follow allonw. Note that I\u0026rsquo;m also just one of many computer scients and not all have the same opinion concering how things are done.\u003c/p\u003e
\u003cp\u003eSo this guide is mostly for myself, but maybe someone finds it helpful too. Let me know if it was a help for you.\u003c/p\u003e
\u003ch2 id=\u0022boot-medium\u0022\u003eBoot Medium\u003c/h2\u003e
\u003cp\u003eOn a Linux Machine with a usb stick plugged in and internet access these commands will turn your usb stick \u003ccode\u003e/dev/sdx\u003c/code\u003e into a bootable Arch Linux medium:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ewget https://theswissbay.ch/archlinux/iso/2021.02.01/archlinux-2021.05.01-x86_64.iso
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecd Download
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003edd \u003cspan style=\u0022color:#66d9ef\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003earchlinux-2021.05.01-x86_64.iso of\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e/dev/sdx bs\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e4M
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOr if you want to learn something new check out \u003ca href=\u0022https://www.ventoy.net/en/index.html\u0022\u003ethis mutliboot software\u003c/a\u003e.\u003c/p\u003e
\u003ch2 id=\u0022preparations-on-live-installation\u0022\u003ePreparations on live installation\u003c/h2\u003e
\u003cp\u003eBefore installing Arch on the actual disk, there are some checks and configs to do on the live installation.\u003c/p\u003e
\u003col\u003e
\u003cli\u003eOutput of the directory below should not be empty, then we are sure we booted in UEFI mode:\u003c/li\u003e
\u003c/ol\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003els /sys/firmware/efi/efivars
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\u00222\u0022\u003e
\u003cli\u003eThe default terminal font is quite small and on most laptops it\u0026rsquo;s hard to read it. We can change it:\u003c/li\u003e
\u003c/ol\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003els /usr/share/kbd/consolefonts \u003cspan style=\u0022color:#75715e\u0022\u003e# list of all available fonts on live system\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esetfont ter-g20b
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\u00223\u0022\u003e
\u003cli\u003ePlug in a cable and check with ping that you have an internet connection:\u003c/li\u003e
\u003c/ol\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eping -c \u003cspan style=\u0022color:#ae81ff\u0022\u003e5\u003c/span\u003e technat.ch
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\u00224\u0022\u003e
\u003cli\u003eIf you want to use WiFi you can configure it for this live session. Replace \u003ccode\u003essid1\u003c/code\u003e with the name of your WiFi and \u003ccode\u003ewlan0\u003c/code\u003e with the name of your wifi card (see \u003ccode\u003eip link\u003c/code\u003e). You will be asked for the password:\u003c/li\u003e
\u003c/ol\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eiwctl station wlan0 connect ssid1
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\u00225\u0022\u003e
\u003cli\u003eenable NTP to have an up to date time during installation:\u003c/li\u003e
\u003c/ol\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003etimedatectl set-ntp true
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\u00226\u0022\u003e
\u003cli\u003egenerate new pacman mirror list with http mirrors close to you (packages are signed with gpg keys, no needs for slower https):\u003c/li\u003e
\u003c/ol\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epacman -Syy
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ereflector —protocol http -c Switzerland —sort rate —save /etc/pacman.d/mirrorlist
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow you should be good to go with the installation. Note that you\u0026rsquo;ll download quite a lot of packages during the installation, so the faster your internet connection is, the less ☕ you\u0026rsquo;ll need :)\u003c/p\u003e
\u003ch2 id=\u0022partitioning\u0022\u003ePartitioning\u003c/h2\u003e
\u003cp\u003eWe are in our live system. But how can we install Arch now? Let\u0026rsquo;s start by partitioning the disk. For this you need the correct drive. You can find it with \u003ccode\u003elsblk\u003c/code\u003e:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eNAME                          MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esda                             8:0    \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e 476.9G  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e disk
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e├─sda1                          8:1    \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e   500M  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e part
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e└─sda2                          8:2    \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e 476.5G  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e part
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esdb                             8:16   \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e 223.6G  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e disk
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e├─sdb1                          8:17   \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e   500M  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e part  /boot
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e└─sdb2                          8:18   \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e 223.1G  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e part
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e  └─cryptlvm                  254:0    \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e 223.1G  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e crypt
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e    ├─vgwall--e-vgcrypt--root 254:1    \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e    60G  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e lvm   /
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e    └─vgwall--e-vgcrypt--home 254:2    \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e  98.7G  \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e lvm   /home
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn my case it\u0026rsquo;s going to be \u003ccode\u003e/dev/sda\u003c/code\u003e. For the rest of this installation all commands will use \u003ccode\u003e/dev/sda\u003c/code\u003e. If your drive is another one change that accordingly.\u003c/p\u003e
\u003cp\u003eBut how does the partitioning layout look like for an Arch installation?\u003c/p\u003e
\u003cp\u003eLike that:\u003c/p\u003e
\u003ctable\u003e
\u003cthead\u003e
\u003ctr\u003e
\u003cth\u003eDrive Letter\u003c/th\u003e
\u003cth\u003ePart Nr\u003c/th\u003e
\u003cth\u003eSize\u003c/th\u003e
\u003cth\u003eType\u003c/th\u003e
\u003c/tr\u003e
\u003c/thead\u003e
\u003ctbody\u003e
\u003ctr\u003e
\u003ctd\u003e/dev/sda1\u003c/td\u003e
\u003ctd\u003e1\u003c/td\u003e
\u003ctd\u003e300M\u003c/td\u003e
\u003ctd\u003e1 EFI System\u003c/td\u003e
\u003c/tr\u003e
\u003ctr\u003e
\u003ctd\u003e/dev/sda2\u003c/td\u003e
\u003ctd\u003e2\u003c/td\u003e
\u003ctd\u003eReminder of the space\u003c/td\u003e
\u003ctd\u003e43 Linux LVM\u003c/td\u003e
\u003c/tr\u003e
\u003c/tbody\u003e
\u003c/table\u003e
\u003cp\u003eAs we have a UEFI system we just need one small boot partition for the bootloader. This is the unencrypted part of the installation. The second partition will be encrypted using LUKS before we use LVM to create logical volumes on top of the LUKS device.\u003c/p\u003e
\u003cp\u003eUsing fdisk, enter the partiton dialog and create a new fresh GPT signature, aka \u003cstrong\u003ewipe all partitions and data!\u003c/strong\u003e\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003efdisk /dev/sda
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eg
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eStill in the dialog type those commands to create the first partition:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003en
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eenter
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eenter
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u002b300M
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003et
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#ae81ff\u0022\u003e1\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd for the second partiton we need those commands:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003en
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eenter
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eenter
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eenter
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003et
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eenter
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#ae81ff\u0022\u003e43\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow we write the changes to the disk and exit the fdisk dialog:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ep
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ew
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\u0022encrypt-lvm-partition-with-luks\u0022\u003eEncrypt LVM partition with LUKS\u003c/h3\u003e
\u003cp\u003eBefore we create logical volumes we encrypt the second partition with LUKS:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecryptsetup luksFormat -v /dev/sda2
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eType YES to continue and enter a strong password twice.\u003c/p\u003e
\u003cp\u003eNow it\u0026rsquo;s encrypted. But we need to install the system on it so let\u0026rsquo;s open it again:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecryptsetup luksOpen /dev/sda2 cryptlvm
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote: when opening the device you have to give it a name I called mine \u003ccode\u003ecryptlvm\u003c/code\u003e but you can name it howevery you want. We will use this name later so remeber it.\u003c/p\u003e
\u003cp\u003eThis will make the LUKS device available as \u003ccode\u003e/dev/mapper/cryptlvm\u003c/code\u003e.\u003c/p\u003e
\u003ch3 id=\u0022lvm\u0022\u003eLVM\u003c/h3\u003e
\u003cp\u003eOn our encryped partition we can now setup LVM. I\u0026rsquo;m going to create multiple logical volumes like that:\u003c/p\u003e
\u003ctable\u003e
\u003cthead\u003e
\u003ctr\u003e
\u003cth\u003eLV Name\u003c/th\u003e
\u003cth\u003eSize\u003c/th\u003e
\u003cth\u003eVG Name\u003c/th\u003e
\u003c/tr\u003e
\u003c/thead\u003e
\u003ctbody\u003e
\u003ctr\u003e
\u003ctd\u003eroot\u003c/td\u003e
\u003ctd\u003e40GB\u003c/td\u003e
\u003ctd\u003evgcrypt\u003c/td\u003e
\u003c/tr\u003e
\u003ctr\u003e
\u003ctd\u003evar\u003c/td\u003e
\u003ctd\u003e20GB\u003c/td\u003e
\u003ctd\u003evgcrypt\u003c/td\u003e
\u003c/tr\u003e
\u003ctr\u003e
\u003ctd\u003etmp\u003c/td\u003e
\u003ctd\u003e5GB\u003c/td\u003e
\u003ctd\u003evgcrypt\u003c/td\u003e
\u003c/tr\u003e
\u003ctr\u003e
\u003ctd\u003evm\u003c/td\u003e
\u003ctd\u003e300GB\u003c/td\u003e
\u003ctd\u003evgcrypt\u003c/td\u003e
\u003c/tr\u003e
\u003ctr\u003e
\u003ctd\u003ehome\u003c/td\u003e
\u003ctd\u003e100GB\u003c/td\u003e
\u003ctd\u003evgcrypt\u003c/td\u003e
\u003c/tr\u003e
\u003c/tbody\u003e
\u003c/table\u003e
\u003cp\u003eSo I start by creating a physical volume (note the \u003ccode\u003ecryptlvm\u003c/code\u003e name specified earlier):\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epvcreate /dev/mapper/crpytlvm
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOn top of this PV we create a volume group:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003evgcreate vgcrypt /dev/mapper/cryptlvm
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd then we need to define our logical volumes:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elvcreate -L 40GB vgcrypt -n root
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elvcreate -L 20GB vgcrypt -n var
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elvcreate -L 5GB  vgcrypt -n tmp
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elvcreate -L 300GB vgcrypt -n vm
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elvcreate -L 100GB vgcrypt -n home
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emodprobe dm_mod
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003evgscan
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003evgchange -ay
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote: It\u0026rsquo;s not necessary to create so many logical volumes. You could also just do the \u003ccode\u003eroot\u003c/code\u003e volume.
But for better separation and overview about where the space is used I created multiple ones.
Also I didn\u0026rsquo;t fill up the entire space of my volume group.
This is usefull if I have to extend a logical volume in the future as extending is easier than shrinking.
But if you want you can also let one volume use the reminder of the space:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elvcreate -l 100%FREE vgcrypt -n home
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf you ever have to shrink an LV and extend another one, see \u003ca href=\u0022https://wiki.technat.cloud/en/Kubernetes/lv_extend\u0022\u003ethis guide\u003c/a\u003e in my Wiki for some tipps how to do this with the Arch ISO.\u003c/p\u003e
\u003ch2 id=\u0022formatting\u0022\u003eFormatting\u003c/h2\u003e
\u003cp\u003eNow that partitioning is done we need to format our volumes. The \u003ccode\u003eboot\u003c/code\u003e partition should be FAT32, for the others you have multiple options, I use ext4.\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkfs.vfat /dev/sda1
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkfs.ext4 /dev/vgcrypt/root
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkfs.ext4 /dev/vgcrypt/var
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkfs.ext4 /dev/vgcrypt/tmp
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkfs.ext4 /dev/vgcrypt/home
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkfs.ext4 /dev/vgcrypt/vm
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022mount-partitions\u0022\u003eMount partitions\u003c/h2\u003e
\u003cp\u003eWe\u0026rsquo;re coming close to the inital bootstrap of Arch. For this we now need to mount our volumes in the live system. I\u0026rsquo;m doing this below \u003ccode\u003e/mnt\u003c/code\u003e, so that from the perspective of the installed system \u003ccode\u003e/mnt\u003c/code\u003e is \u003ccode\u003e/\u003c/code\u003e:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emount /dev/vgcrypt/root /mnt
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkdir -p /mnt/\u003cspan style=\u0022color:#f92672\u0022\u003e{\u003c/span\u003ehome,boot,vm,tmp,var,etc\u003cspan style=\u0022color:#f92672\u0022\u003e}\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emount /dev/vgcrypt/home /mnt/home
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emount /dev/vgcrypt/vm /mnt/vm
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emount /dev/vgcrypt/tmp /mnt/tmp
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emount /dev/vgcrypt/var /mnt/var
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emount /dev/sda1 /mnt/boot
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022generate-fstab-file\u0022\u003eGenerate fstab file\u003c/h2\u003e
\u003cp\u003eBefore bootstraping let\u0026rsquo;s create a \u003ccode\u003efstab\u003c/code\u003e file for our new system. The Arch ISO has a tool called \u003ccode\u003egenfstab\u003c/code\u003e that generates the fstab file for you:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003egenfstab -U -p /mnt \u0026gt;\u0026gt; /mnt/etc/fstab
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMy \u003ccode\u003e/mnt/etc/fstab\u003c/code\u003e file then looks like this:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#75715e\u0022\u003e# /dev/mapper/vgcrypt-root\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eUUID\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e083b5377-f768-445b-81eb-0154ee77bb75       /               ext4            rw,relatime     \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e \u003cspan style=\u0022color:#ae81ff\u0022\u003e1\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#75715e\u0022\u003e# /dev/mapper/vgcrypt-home\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eUUID\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e21c4372a-88d5-406d-b7e2-a88aea95dedd       /home           ext4            rw,relatime     \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e \u003cspan style=\u0022color:#ae81ff\u0022\u003e2\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#75715e\u0022\u003e# /dev/mapper/vgcrypt-vm\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eUUID\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e39635044-d2b3-42fa-b24c-ebf1602d558d       /vm             ext4            rw,relatime     \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e \u003cspan style=\u0022color:#ae81ff\u0022\u003e2\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#75715e\u0022\u003e# /dev/mapper/vgcrypt-tmp\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eUUID\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e91858b84-ef95-45cc-bc83-eb60b22a8646       /tmp            ext4            rw,relatime     \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e \u003cspan style=\u0022color:#ae81ff\u0022\u003e2\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#75715e\u0022\u003e# /dev/mapper/vgcrypt-var\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eUUID\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003ede61f80f-529b-4884-99e1-f034a2542f8f       /var            ext4            rw,relatime     \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e \u003cspan style=\u0022color:#ae81ff\u0022\u003e2\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#75715e\u0022\u003e# /dev/sda1\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eUUID\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e73FB-6274          /boot           vfat            rw,relatime,fmask\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e0022,dmask\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e0022,codepage\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e437,iocharset\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003eascii,shortname\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003emixed,utf8,errors\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003eremount-ro   \u003cspan style=\u0022color:#ae81ff\u0022\u003e0\u003c/span\u003e \u003cspan style=\u0022color:#ae81ff\u0022\u003e2\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote: UUIDs will be different on every system.\u003c/p\u003e
\u003ch2 id=\u0022bootstrap-system\u0022\u003eBootstrap system\u003c/h2\u003e
\u003cp\u003eNow we are ready to get a system on our disk. In Arch there is a tool called \u003ccode\u003epacstrap\u003c/code\u003e that does the heavy lifting for us.\u003c/p\u003e
\u003cp\u003eTo start we install the \u003ccode\u003ebase\u003c/code\u003e package alongside the \u003ccode\u003elinux\u003c/code\u003e package (which is the actual kernel). Then we also install \u003ccode\u003elvm2\u003c/code\u003e because the system needs lvm support. The \u003ccode\u003elinux-firmware\u003c/code\u003e package contains drivers for many hardware and is in my case used to get the correct WiFi drivers. The last \u003ccode\u003ebase-devel\u003c/code\u003e package contains multiple tools for development and compiling. It\u0026rsquo;s usually required for packages from the AUR (they are compiled locally) alongside the \u003ccode\u003elinux-headers\u003c/code\u003e which is also required for compiling some tools.\u003c/p\u003e
\u003cp\u003eSo we call pacstrap to install those tools on our mounted disk:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epacstrap -i /mnt base base-devel linux linux-firmware lvm2 linux-headers
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAlternatively you could install the LTS-kernel. The LTS or Long-Time-Support kernel is known for it\u0026rsquo;s focus on stability and it\u0026rsquo;s security updates over many years. It can be a good idea to actually install both so you always have a fallback if your main kernel breaks something on an upgrade. However if something is wrong with your installation (if you mixed up your initramfs or you forgot to remove a mount from fstab for example) the LTS kernel won\u0026rsquo;t help you as the root disk is still the same.\u003c/p\u003e
\u003cp\u003eAnyway the new pacstrap command would be:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epacstrap -i /mnt base base-devel linux-lts linux-firmware lvm2 linux-lts-headers
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\u0022arch-chroot\u0022\u003earch-chroot\u003c/h3\u003e
\u003cp\u003eAfter we\u0026rsquo;ve installed the base system we can change our root to \u003ccode\u003e/mnt\u003c/code\u003e so that we can do further configurations to the os-disk:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003earch-chroot /mnt
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022install-system-packages\u0022\u003eInstall system packages\u003c/h2\u003e
\u003cp\u003eOn top of the base system we are going to install several system packages:\u003c/p\u003e
\u003cul\u003e
\u003cli\u003e\u003ccode\u003evim\u003c/code\u003e: To edit system files and because it\u0026rsquo;s my favourite editor\u003c/li\u003e
\u003cli\u003e\u003ccode\u003eintel-ucode\u003c/code\u003e or \u003ccode\u003eamd-ucode\u003c/code\u003e Microcode update files for Intel | AMD CPUs\u003c/li\u003e
\u003cli\u003e\u003ccode\u003eterminus-font\u003c/code\u003e the font we are currently using is part of this package\u003c/li\u003e
\u003cli\u003e\u003ccode\u003enetworkmanager\u003c/code\u003e as networking solution of choice (alternatives \u003ca href=\u0022https://wiki.archlinux.org/index.php/Network_configuration\u0022\u003ehere\u003c/a\u003e)\u003c/li\u003e
\u003cli\u003e\u003ccode\u003ednsutils\u003c/code\u003e for DNS debugging capability\u003c/li\u003e
\u003cli\u003e\u003ccode\u003eopenssh\u003c/code\u003e for the SSH client\u003c/li\u003e
\u003cli\u003e\u003ccode\u003eiptables-nft\u003c/code\u003e newer iptables, for details see \u003ca href=\u0022https://www.redhat.com/en/blog/using-iptables-nft-hybrid-linux-firewall\u0022\u003ehere\u003c/a\u003e\u003c/li\u003e
\u003cli\u003e\u003ccode\u003ebluez\u003c/code\u003e and \u003ccode\u003ebluez-utils\u003c/code\u003efor bluetooth functionality\u003c/li\u003e
\u003cli\u003e\u003ccode\u003exdg-utils\u003c/code\u003e and \u003ccode\u003exdg-user-dirs\u003c/code\u003e for some default folders and utilities to work with desktops\u003c/li\u003e
\u003cli\u003e\u003ccode\u003entfs-3g\u003c/code\u003e for NTFS support\u003c/li\u003e
\u003cli\u003e\u003ccode\u003emtools\u003c/code\u003e and \u003ccode\u003edosfstools\u003c/code\u003e for support of FAT file systems\u003c/li\u003e
\u003cli\u003e\u003ccode\u003enfs-utils\u003c/code\u003e for NFS support\u003c/li\u003e
\u003cli\u003e\u003ccode\u003ecups\u003c/code\u003e for the printing system\u003c/li\u003e
\u003cli\u003e\u003ccode\u003esudo\u003c/code\u003e to run commands with super-user privileges\u003c/li\u003e
\u003cli\u003e\u003ccode\u003ehplip\u003c/code\u003e for HP printing support\u003c/li\u003e
\u003cli\u003e\u003ccode\u003egvfs\u003c/code\u003e and \u003ccode\u003egvfs-smb\u003c/code\u003e for an API to virtual file systems\u003c/li\u003e
\u003cli\u003e\u003ccode\u003epipewire\u003c/code\u003e as linux sound server\u003c/li\u003e
\u003cli\u003e\u003ccode\u003epipewire-alsa\u003c/code\u003e, \u003ccode\u003epipewire-pulseaudio\u003c/code\u003e and \u003ccode\u003epipewire-jack\u003c/code\u003e to route apps to pipewire\u003c/li\u003e
\u003c/ul\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epacman -Syy
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epacman -S vim intel-ucode terminus-font networkmanager dnsutils openssh iptables-nft bluez bluez-tuils xdg-utils xdg-user-dirs ntfs-3g mtools dosfstools nfs-utils cups sudo hplip gvfs gvfs-smb pipewire pipewire-alsa pipewire-pulse pipewire-jack
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eChoose wireplumber when asked what to use as dependency fir pipewire and confirm that we replace iptables with iptables-nft.\u003c/p\u003e
\u003cp\u003eAfter the tools are installed, we enable some of the important services:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo systemctl enable NetworkManager
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo systemctl enable bluetooth
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo systemctl enable cups
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo systemctl enable fstrim.timer
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022regional-settings\u0022\u003eRegional Settings\u003c/h2\u003e
\u003cp\u003eOnce the packages are there we go on and configure our regional stuff. We start by generating our locales in \u003ccode\u003e/etc/locale.gen\u003c/code\u003e. Uncomment your appropriate language and then generate the language pack:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elocale-gen
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe configured language needs to be set in the \u003ccode\u003e/etc/locale.conf\u003c/code\u003e file as follows:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eLANG\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003een_US.UTF-8
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe installed the terminus-font package so let\u0026rsquo;s make use of it by setting our font in the \u003ccode\u003e/etc/vconsole.conf\u003c/code\u003e file.
If you want to try a font use \u003ccode\u003esetfont\u003c/code\u003e to change the font, this will not persist over reboots. A list of all available fonts in the system can be seen in \u003ccode\u003e/usr/share/kdb/consolefonts/\u003c/code\u003e\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eFONT\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003eter-g20b
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo set the timezone we just use a hardlink to \u003ccode\u003e/etc/localetime\u003c/code\u003e like so:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eln -sf /usr/share/zoneinfo/Europe/Zurich /etc/localtime
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003etimedatectl set-ntp true
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ehwclock --systohc
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI\u0026rsquo;m using the english (US) Layout, so theroretically I don\u0026rsquo;t need to change anything on the keyboard layout. However because I\u0026rsquo;m from Switzerland and you sometimes need to write something in swiss german I need to type öüä quite a lot. So I switched from standard english (US) to english (Intl., with AltGr dead keys).
Anyway here\u0026rsquo;s how you could change the default keyboard layout:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elocalectl list-keymaps \u003cspan style=\u0022color:#75715e\u0022\u003e# list all available keymaps\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eand then add the keymap to \u003ccode\u003e/etc/vconsole.conf\u003c/code\u003e as follows:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eKEYMAP\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003eus-acentos
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022sudo\u0022\u003eSudo\u003c/h2\u003e
\u003cp\u003eAdd the following to \u003ccode\u003e/etc/sudoers\u003c/code\u003e using \u003ccode\u003eEDITOR=vim visudo\u003c/code\u003e to allow the wheel group to run sudo commands:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e%wheel ALL\u003cspan style=\u0022color:#f92672\u0022\u003e=(\u003c/span\u003eALL\u003cspan style=\u0022color:#f92672\u0022\u003e)\u003c/span\u003e ALL \u003cspan style=\u0022color:#75715e\u0022\u003e#--\u0026gt; will prompt for password when using sudo\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e%wheel ALL\u003cspan style=\u0022color:#f92672\u0022\u003e=(\u003c/span\u003eALL\u003cspan style=\u0022color:#f92672\u0022\u003e)\u003c/span\u003e NOPASSWD: ALL \u003cspan style=\u0022color:#75715e\u0022\u003e#--\u0026gt; won\u0026#39;t prompt for password when using sudo\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022initramfs\u0022\u003einitramfs\u003c/h2\u003e
\u003cp\u003eAs the documentation for Arch Linux says the initramfs should automatically be generated when installing the base system with pacstrap. But the default HOOKS in the initramfs don\u0026rsquo;t contain support for LVM and LUKS, so we add them.\u003c/p\u003e
\u003cp\u003eI edit \u003ccode\u003e/etc/mkinitcpio.conf\u003c/code\u003e and change the HOOKS line to match that:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eHOOKS\u003cspan style=\u0022color:#f92672\u0022\u003e=(\u003c/span\u003ebase systemd keyboard sd-vconsole autodetect modconf block sd-encrypt lvm2 fsck filesystems\u003cspan style=\u0022color:#f92672\u0022\u003e)\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf you want to know more about the order and the hooks for the initramfs I highly recommend reading \u003ca href=\u0022https://wiki.archlinux.org/index.php/Mkinitcpio\u0022\u003ethis page\u003c/a\u003e.\u003c/p\u003e
\u003cp\u003eIf we change something in this file, we need to regenerate the initramfs:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkinitcpio -p linux
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkinitcpio -p linux-lts \u003cspan style=\u0022color:#75715e\u0022\u003e# if you have an LTS kernel\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022root-password\u0022\u003eroot password\u003c/h2\u003e
\u003cp\u003eTo login after the reboot we need to a root password:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epasswd
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022hostname\u0022\u003eHostname\u003c/h2\u003e
\u003cp\u003eSet the hostname of the machine like so:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eecho WALL-E \u0026gt; /etc/hostname
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd adjust the /etc/hosts file accordingly:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecat \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026lt;\u0026lt;EOF \u0026gt;/etc/hosts
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003e127.0.0.1 localhost
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003e::1   localhost
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003e127.0.1.1 WALL-E.localdomain WALL-E
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003eEOF\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022bootloader\u0022\u003ebootloader\u003c/h2\u003e
\u003cp\u003eAt the beginning of the tutorial I said that this installation is a UEFI installation and that I\u0026rsquo;m going to use systemd-boot as my bootloader. There are mutliple options depending on your preference and your setup. See \u003ca href=\u0022https://wiki.archlinux.org/index.php/Arch_boot_process\u0022\u003ehere\u003c/a\u003e for more information on other options.\u003c/p\u003e
\u003cp\u003eWith \u003ccode\u003esystemd-boot\u003c/code\u003e we initialize the bootloader first:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esystemd-machine-id-setup
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ebootctl --path\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e/boot install
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow we need to create a bootloader entry for Arch. For this we need to know the UUID of the root device (the partition mounted on \u003ccode\u003e/\u003c/code\u003e). We get it with the following command:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003euuid\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e\u003cspan style=\u0022color:#66d9ef\u0022\u003e\$(\u003c/span\u003eblkid --match-tag UUID -o value /dev/sda2\u003cspan style=\u0022color:#66d9ef\u0022\u003e)\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that we don\u0026rsquo;t get the UUID of the actual \u003ccode\u003eroot\u003c/code\u003e logical volume but instead of the second parttion. This is fine as we specify the LV to be used in the bootloader entry afterwards. If you don´t use LVM, you would get the UUID of the root partition.\u003c/p\u003e
\u003cp\u003eSo let\u0026rsquo;s add an entry to our bootloader:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecat \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026lt;\u0026lt;EOF \u0026gt;/boot/loader/entries/arch.conf
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003etitle   Arch Linux
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003elinux   /vmlinuz-linux
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003einitrd /intel-ucode.img
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003einitrd  /initramfs-linux.img
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003e# initrd /initramfs-linux-lts.img
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003eoptions rd.luks.name=\${uuid}=cryptlvm root=/dev/vgcrypt/root
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003eEOF\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd we also change the bootloader config to use the above entry as default:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecat \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026lt;\u0026lt;EOF \u0026gt;/boot/loader/loader.conf
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003edefault arch
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003e#default arch-lts
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003etimeout 0
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003eeditor 0
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003eEOF\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe \u003ccode\u003eeditor 0\u003c/code\u003e directive disables the option to add kernel parameters during boot. The \u003ccode\u003etimeout 0\u003c/code\u003e  waits 0 seconds before continuing to boot. So you won\u0026rsquo;t see the bootloader with the different options at all, if you don\u0026rsquo;t press space during boot.\u003c/p\u003e
\u003ch2 id=\u0022keyfile\u0022\u003eKeyfile\u003c/h2\u003e
\u003cp\u003eOn my machine I have a problem which causes the keyboard to not work during the early boot process (BIOS problem) even with the keyboard hook in initramfs.
So I used a workaround which uses a keyfile stored in the initramfs to unlock the LUKS partition. This is not very secure as the initramfs is stored on the \u003ccode\u003e/dev/sda1\u003c/code\u003e partition which is not encrypted and anyone with access to the disk could extract the keyfile and then decrypt your data. A better option would be to store the keyfile on a thumb drive and insert this everytime you boot. But I\u0026rsquo;m not at a point where I think this is necessary for me. If you want to do it you can read everything about it \u003ca href=\u0022https://wiki.archlinux.org/title/Dm-crypt/Device_encryption\u0022\u003ehere\u003c/a\u003e.\u003c/p\u003e
\u003cp\u003eSo that\u0026rsquo;s what I did to fix my problem:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003edd bs\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e\u003cspan style=\u0022color:#ae81ff\u0022\u003e512\u003c/span\u003e count\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e\u003cspan style=\u0022color:#ae81ff\u0022\u003e4\u003c/span\u003e \u003cspan style=\u0022color:#66d9ef\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e/dev/random of\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e/keyfile iflag\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003efullblock
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003echmod \u003cspan style=\u0022color:#ae81ff\u0022\u003e400\u003c/span\u003e /etc/mykeyfile
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecryptsetup luksAddKey /dev/sda2 /keyfile
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ethen in the \u003ccode\u003e/etc/mkinitcpio.conf\u003c/code\u003e file I added the following to the FILES and MODULES array:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eFILES\u003cspan style=\u0022color:#f92672\u0022\u003e=(\u003c/span\u003e/keyfile\u003cspan style=\u0022color:#f92672\u0022\u003e)\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eMODULES\u003cspan style=\u0022color:#f92672\u0022\u003e=(\u003c/span\u003eext4\u003cspan style=\u0022color:#f92672\u0022\u003e)\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRegenerated the initramfs:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkinitcpio -p linux
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eand then modified the options line in the boot entry by adding the keyfile:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eoptions rd.luks.key\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003e\${\u003c/span\u003euuid\u003cspan style=\u0022color:#e6db74\u0022\u003e}\u003c/span\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e/keyfile
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022success\u0022\u003eSuccess?\u003c/h2\u003e
\u003cp\u003eSo this is it for the installation. Now you can \u003ccode\u003eexit\u003c/code\u003e the arch-chroot environment and \u003ccode\u003ereboot\u003c/code\u003e the system to proofe that you successfully installed a working Arch Linux!\u003c/p\u003e
\u003cp\u003eIf the installation fails to boot, I recommend you boot back into the live system, decrypt the LUKS partition, mount the volumes again and take another look at your boot entry.\u003c/p\u003e
\u003cp\u003eFrom my experience typos in the bootloader config are the most common cause of problems :=)\u003c/p\u003e
\u003ch2 id=\u0022recommended-first-steps\u0022\u003eRecommended first steps\u003c/h2\u003e
\u003cp\u003eBefore using your system I recommend you do some basic steps, some of them are optional, some of them are quite important.\u003c/p\u003e
\u003ch2 id=\u0022personal-user\u0022\u003ePersonal user\u003c/h2\u003e
\u003cp\u003eThere are reasons why we shouldn\u0026rsquo;t work with \u003ccode\u003eroot\u003c/code\u003e day by day:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo pacman -S zsh
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003euseradd -m -g users -G wheel,storage,power -s /usr/bin/zsh technat
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epasswd technat
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\u0022networking\u0022\u003eNetworking\u003c/h2\u003e
\u003cp\u003eNow that NetworkManager is running, we canu se it to connect to WiFis:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003enmcli device wifi list
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003enmcli device wifi connect SSID password password
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMore information about \u003ccode\u003enmcli\u003c/code\u003e can be found \u003ca href=\u0022https://wiki.archlinux.org/index.php/NetworkManager#nmcli_examples\u0022\u003ehere\u003c/a\u003e. Note that there is also a more user-firendly \u003ccode\u003enmtui\u003c/code\u003e that can also be used to interact with \u003ccode\u003eNetworkManager\u003c/code\u003e.\u003c/p\u003e
\u003cp\u003eWell not always Networking (and especially WiFi) works as expected. So let\u0026rsquo;s take a step back and go through all the things that could go wrong.\u003c/p\u003e
\u003ch3 id=\u0022check-drivers\u0022\u003eCheck drivers\u003c/h3\u003e
\u003cp\u003eThe most important thing is to see wether the system has detected our network interface and can use it by loading the correct driver for it. Normally the linux kernel does a good job by picking the correct default driver for your network interface (that\u0026rsquo;s why you have \u003ccode\u003elinux-firmware\u003c/code\u003e package). Let\u0026rsquo;s check if he did:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003elspci -k | grep -i net -A \u003cspan style=\u0022color:#ae81ff\u0022\u003e3\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eYou should see at least one network interface listed. My output is as follows:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection I219-LM \u003cspan style=\u0022color:#f92672\u0022\u003e(\u003c/span\u003erev 21\u003cspan style=\u0022color:#f92672\u0022\u003e)\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Subsystem: Fujitsu Limited. Device 192c
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Kernel driver in use: e1000e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Kernel modules: e1000e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e02:00.0 Network controller: Intel Corporation Wireless \u003cspan style=\u0022color:#ae81ff\u0022\u003e8260\u003c/span\u003e \u003cspan style=\u0022color:#f92672\u0022\u003e(\u003c/span\u003erev 3a\u003cspan style=\u0022color:#f92672\u0022\u003e)\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Subsystem: Intel Corporation Dual Band Wireless-AC \u003cspan style=\u0022color:#ae81ff\u0022\u003e8260\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Kernel driver in use: iwlwifi
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Kernel modules: iwlwifi
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf the NIC\u0026rsquo;s are not listed you need to find the correct drivers manually. See \u003ca href=\u0022https://wiki.archlinux.org/index.php/Network_configuration/Ethernet#Device_driver\u0022\u003ehere\u003c/a\u003e or \u003ca href=\u0022https://wiki.archlinux.org/index.php/Network_configuration/Wireless#Device_driver\u0022\u003ehere\u003c/a\u003e for more information on how to get network drivers and load them.\u003c/p\u003e
\u003ch3 id=\u0022dns\u0022\u003eDNS\u003c/h3\u003e
\u003cp\u003eNetworkManager has multiple ways to resolve Names. One is to delegate DNS to the \u003ccode\u003esystemd-resolved\u003c/code\u003e service. For this the following has to be set:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo cat \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026lt;\u0026lt;EOF \u0026gt;/etc/NetworkManager/conf.d/dns.conf
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003e[main]
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003edns=systemd-resolved
\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#e6db74\u0022\u003eEOF\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo systemctl enable --now systemd-resolved
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFrom now on DNS is completly managed by \u003ccode\u003esystemd-resolved\u003c/code\u003e.
Note: \u003ccode\u003e/etc/resolv.conf\u003c/code\u003e is now also managed by \u003ccode\u003esystemd-resolved\u003c/code\u003e. See \u003ca href=\u0022https://wiki.archlinux.org/title/NetworkManager#/etc/resolv.conf\u0022\u003ethis page\u003c/a\u003e for how NetworkManager uses or doesn\u0026rsquo;t use the \u003ccode\u003e/etc/resolv.conf\u003c/code\u003e file.\u003c/p\u003e
\u003ch3 id=\u0022captive-portals\u0022\u003eCaptive portals\u003c/h3\u003e
\u003cp\u003eSee \u003ca href=\u0022https://wiki.archlinux.org/title/NetworkManager#Configuration\u0022\u003eNetworkManager\u003c/a\u003e for a list of solutions to make networmanager open a browser window when you connect to a network that has a captive portal.\u003c/p\u003e
\u003ch3 id=\u0022wpa2_enterprise-networks\u0022\u003eWPA2_Enterprise Networks\u003c/h3\u003e
\u003cp\u003eUniversities and schools often use wpa2-enterprise networks where you have to authenticate yourself with credentials instead of a pre-shared-key.
NetworkManager can connect to such WiFi\u0026rsquo;s but seems like you have to do it via a manual added connection.\u003c/p\u003e
\u003cp\u003eSo create a file in \u003ccode\u003e/etc/NetworkManager/system-connections/[CONNECTION_NAME].nmconnection\u003c/code\u003e and place the following content in it:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003econnection\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eid\u003cspan style=\u0022color:#f92672\u0022\u003e=[\u003c/span\u003eCONNECTION_NAME\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003euuid\u003cspan style=\u0022color:#f92672\u0022\u003e=[\u003c/span\u003eUUID\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003etype\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003ewifi
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003einterface-name\u003cspan style=\u0022color:#f92672\u0022\u003e=[\u003c/span\u003eWIFI-INTERFACE NAME\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epermissions\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003ewifi\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emac-address-blacklist\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emode\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003einfrastructure
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003essid\u003cspan style=\u0022color:#f92672\u0022\u003e=[\u003c/span\u003eSSID\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003ewifi-security\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eauth-alg\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003eopen
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ekey-mgmt\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003ewpa-eap
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003e802-1x\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eeap\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003epeap;
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eidentity\u003cspan style=\u0022color:#f92672\u0022\u003e=[\u003c/span\u003eUSERNAME\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003epassword\u003cspan style=\u0022color:#f92672\u0022\u003e=[\u003c/span\u003ePASSWORD\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ephase2-auth\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003emschapv2
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003eipv4\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003edns-search\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emethod\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003eauto
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003eipv6\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eaddr-gen-mode\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003estable-privacy
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003edns-search\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emethod\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003eauto
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003eproxy\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eReplace the [] place holder with the correct values. An UUID can be generated with \u003ccode\u003euuidgen\u003c/code\u003e.\u003c/p\u003e
\u003cp\u003eOr see the \u003ca href=\u0022https://github.com/wylermr/NetworkManager-WPA2-Enterprise-Setup\u0022\u003eWiki Page\u003c/a\u003e with a similar description.\u003c/p\u003e
\u003ch2 id=\u0022bluetooth\u0022\u003eBluetooth\u003c/h2\u003e
\u003cp\u003eThe packages are already installed and the service is enabled. Use \u003ccode\u003ebluetoothctl\u003c/code\u003e to connect your devices.\u003c/p\u003e
\u003cp\u003eFor automatic power on of the bluetooth adapter at boot, edit the file \u003ccode\u003e/etc/bluetooth/main.cf\u003c/code\u003e and uncomment the following line:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e\u003cspan style=\u0022color:#f92672\u0022\u003e[\u003c/span\u003ePolicy\u003cspan style=\u0022color:#f92672\u0022\u003e]\u003c/span\u003e
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eAutoEnable\u003cspan style=\u0022color:#f92672\u0022\u003e=\u003c/span\u003etrue
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\u0022troubleshooting\u0022\u003eTroubleshooting\u003c/h3\u003e
\u003cp\u003eIf you have errors with connecting devices or powering on the adapter, you can try the following.\u003c/p\u003e
\u003ch4 id=\u0022drivers\u0022\u003eDrivers\u003c/h4\u003e
\u003cp\u003eTo check if btusb is loaded and used run a \u003ccode\u003elsmod | grep btusb\u003c/code\u003e\u003c/p\u003e
\u003cp\u003eYou should see that bluetooth is using it:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ebluetooth             \u003cspan style=\u0022color:#ae81ff\u0022\u003e720896\u003c/span\u003e  \u003cspan style=\u0022color:#ae81ff\u0022\u003e43\u003c/span\u003e btrtl,btintel,btbcm,bnep,btusb,rfcomm
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\u0022blocks\u0022\u003eBlocks\u003c/h4\u003e
\u003cp\u003eIt\u0026rsquo;s also possible that rfkill blocks the bluetooth module which can cause special behaviours. Check that with \u003ccode\u003erfkill list\u003c/code\u003e:\u003c/p\u003e
\u003cp\u003eMy output was as following:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e0: hci0: Bluetooth
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Soft blocked: yes
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Hard blocked: no
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e1: phy0: Wireless LAN
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Soft blocked: no
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e        Hard blocked: no
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThere is a \u0026ldquo;yes\u0026rdquo; by soft blocked bluetooth. I fixed this by running \u003ccode\u003erkfill unblock bluetooth\u003c/code\u003e.\u003c/p\u003e
\u003ch3 id=\u0022bluetooth-headsets\u0022\u003eBluetooth Headsets\u003c/h3\u003e
\u003cp\u003eFor bluetooth headsets see this \u003ca href=\u0022https://wiki.archlinux.org/title/Bluetooth_headset#Disable_auto_switching_headset_to_HSP/HFP\u0022\u003ewiki page\u003c/a\u003e.\u003c/p\u003e
\u003ch2 id=\u0022swapfile\u0022\u003eSwapfile\u003c/h2\u003e
\u003cp\u003eMy Arch Installation has no SWAP partition. That\u0026rsquo;s because swapfiles are also good and they are way more flexible. Configure one like that:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003efallocate -l 2G /swapfile
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003echmod \u003cspan style=\u0022color:#ae81ff\u0022\u003e600\u003c/span\u003e /swapfile
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emkswap /swapfile
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecp /etc/fstab /etc/fstab.bak
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eecho \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026#39;/swapfile none swap sw 0 0\u0026#39;\u003c/span\u003e | tee -a /etc/fstab
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecat /etc/fstab
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTipp: Read about SWAP in the \u003ca href=\u0022https://wiki.archlinux.org/title/Swap\u0022\u003earch linux wiki\u003c/a\u003e or take a look at \u003ca href=\u0022https://wiki.archlinux.org/title/Improving_performance#zram_or_zswap\u0022\u003ezram\u003c/a\u003e\u003c/p\u003e
\u003ch2 id=\u0022aur-helper\u0022\u003eAUR Helper\u003c/h2\u003e
\u003cp\u003eTo install packages from the Arch User Repository you\u0026rsquo;ll either need to do it manually or install a helper which get\u0026rsquo;s your new package manager. It will be able to compile packages from the AUR as well as us pacman in the back to install regular packages. I use yay for that but there are other options as well:\u003c/p\u003e
\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003esudo pacman -S git go
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003egit clone https://aur.archlinux.org/yay.git
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003ecd yay
\u003c/span\u003e\u003c/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003emakepkg -si
\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote: Once yay is installed it can update itself in the future ;)\u003c/p\u003e
\u003ch2 id=\u0022whats-next\u0022\u003eWhat\u0026rsquo;s next?\u003c/h2\u003e
\u003cp\u003eOkay now you have a decent system which you can work with. But there is still no graphical interface. Depending on your use case for the machine this might be fine. For me I need some sort of a graphical environment to work. If you are interested on how I have done that see my \u003ca href=\u0022https://wiki.technat.cloud/en/Linux/sway-de\u0022\u003eSway-DE Guide\u003c/a\u003e. There I noted how to do these things and much more.\u003c/p\u003e
\u003ch2 id=\u0022fruther-reading\u0022\u003eFruther Reading\u003c/h2\u003e
\u003cul\u003e
\u003cli\u003e\u003ca href=\u0022https://paedubucher.ch/articles/2020-09-26-arch-linux-setup-with-disk-encryption.html\u0022\u003ehttps://paedubucher.ch/articles/2020-09-26-arch-linux-setup-with-disk-encryption.html\u003c/a\u003e\u003c/li\u003e
\u003c/ul\u003e
\u003c/span\u003e`,"activity-content",contentDelay)};typeeffetct()</script></div><span class=navFull><span><a href=/>Home</a>
<span>&#8192;|&#8192;</span>
<a href=./..>/linux/</a></span>
<span class=navCredits>Hugo theme created by
<a href=https://github.com/Yukuro/hugo-theme-shell target=_blank rel=noopener>Yukuro</a></span></span></body></html>